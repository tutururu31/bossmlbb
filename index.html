<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLBB Битва с Боссами</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Приветственное сообщение -->
    <div id="welcome-message" class="welcome-message active">
        <div class="welcome-content">
            <h1><i class="fas fa-dragon"></i> MLBB Битва с Боссами</h1>
            <p class="welcome-description">
                Сражайся с могучим боссом, улучшай свои способности и фарми монстров для золота!
                Покажи, кто здесь настоящий герой!
            </p>
            <div class="welcome-features">
                <div class="feature">
                    <i class="fas fa-skull-crossbones"></i>
                    <span>Босс на 100,000 HP</span>
                </div>
                <div class="feature">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Улучшения в магазине</span>
                </div>
                <div class="feature">
                    <i class="fas fa-spider"></i>
                    <span>5 видов монстров</span>
                </div>
                <div class="feature">
                    <i class="fas fa-chart-line"></i>
                    <span>Детальная статистика</span>
                </div>
            </div>
            <button id="start-game-btn" class="start-game-btn">
                <i class="fas fa-play-circle"></i> НАЧАТЬ ИГРУ
            </button>
        </div>
    </div>

    <div class="container" id="game-container" style="display: none;">
        <header>
            <div class="gold-display">
                <i class="fas fa-coins"></i>
                <span id="gold">100</span> золота
            </div>
        </header>

        <main>
            <!-- Вкладка Главный Босс -->
            <section id="boss-tab" class="tab-content active">
                <div class="boss-container">
                    <div class="boss-info">
                        <h2><i class="fas fa-crown"></i> Грозный Дракон</h2>
                        <div class="hp-bar-container">
                            <div class="hp-bar" id="boss-hp-bar"></div>
                            <div class="hp-text" id="boss-hp-text">100000 / 100000 HP</div>
                        </div>
                    </div>
                    <div class="boss-image" id="boss-click-area">
                        <div class="boss-avatar">
                            <i class="fas fa-dragon"></i>
                        </div>
                        <div class="click-hint">КЛИКАЙ СЮДА!</div>
                    </div>
                    <div class="combat-log" style="display: none;">
                        <h3><i class="fas fa-scroll"></i> Боевой лог</h3>
                        <div id="log-content">
                            <div>Добро пожаловать в битву с боссом!</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Вкладка Магазин -->
            <section id="shop-tab" class="tab-content">
                <h2><i class="fas fa-store"></i> Улучшения</h2>
                <div class="shop-items">
                    <div class="shop-item" data-id="clickDamage">
                        <div class="item-icon">
                            <i class="fas fa-fist-raised"></i>
                        </div>
                        <div class="item-info">
                            <h3>Усиленный удар</h3>
                            <p>Увеличивает урон за клик на +1</p>
                            <div class="item-stats">
                                Уровень: <span id="clickDamage-lvl">0</span>
                            </div>
                        </div>
                        <button class="buy-btn" data-id="clickDamage">
                            Купить: <span id="clickDamage-cost">10</span> <i class="fas fa-coins"></i>
                        </button>
                    </div>

                    <div class="shop-item" data-id="autoclicker">
                        <div class="item-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="item-info">
                            <h3>Автокликер</h3>
                            <p>Автоматически бьёт босса каждые 10 минут</p>
                            <div class="item-stats">
                                Состояние: <span id="autoclicker-status">Неактивен</span>
                            </div>
                        </div>
                        <button class="buy-btn" data-id="autoclicker">
                            Купить: <span id="autoclicker-cost">500</span> <i class="fas fa-coins"></i>
                        </button>
                    </div>

                    <div class="shop-item" data-id="criticalChance">
                        <div class="item-icon">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <div class="item-info">
                            <h3>Шанс крита</h3>
                            <p>Увеличивает шанс критического удара на 1%</p>
                            <div class="item-stats">
                                Уровень: <span id="criticalChance-lvl">0</span>
                            </div>
                        </div>
                        <button class="buy-btn" data-id="criticalChance">
                            Купить: <span id="criticalChance-cost">50</span> <i class="fas fa-coins"></i>
                        </button>
                    </div>

                    <div class="shop-item" data-id="criticalDamage">
                        <div class="item-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="item-info">
                            <h3>Сила крита</h3>
                            <p>Увеличивает множитель критического урона на 0.2</p>
                            <div class="item-stats">
                                Уровень: <span id="criticalDamage-lvl">0</span>
                            </div>
                        </div>
                        <button class="buy-btn" data-id="criticalDamage">
                            Купить: <span id="criticalDamage-cost">100</span> <i class="fas fa-coins"></i>
                        </button>
                    </div>

                    <div class="shop-item" data-id="periodicDamage">
                        <div class="item-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="item-info">
                            <h3>Огненная аура</h3>
                            <p>Наносит периодический урон боссу каждые 30 секунд</p>
                            <div class="item-stats">
                                Уровень: <span id="periodicDamage-lvl">0</span> (урон: <span id="periodicDamage-dmg">0</span>)
                            </div>
                        </div>
                        <button class="buy-btn" data-id="periodicDamage">
                            Купить: <span id="periodicDamage-cost">200</span> <i class="fas fa-coins"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Вкладка Монстры -->
            <section id="monsters-tab" class="tab-content">
                <h2><i class="fas fa-spider"></i> Ферма монстров</h2>
                <p class="description">Убивайте монстров, чтобы зарабатывать золото. Автокликер здесь не работает!</p>
                
                <div class="current-monster-container">
                    <div class="monster-spawn-notification" id="monster-spawn-notification" style="display: none;">
                        Появился новый монстр!
                    </div>
                    <div class="monster" id="current-monster">
                        <!-- Монстр будет вставлен сюда динамически -->
                        <div class="monster-icon">
                            <i class="fas fa-question"></i>
                        </div>
                        <div class="monster-info">
                            <h3 id="current-monster-name">Загрузка...</h3>
                            <div class="monster-hp">
                                HP: <span id="current-monster-hp">0</span>/<span id="current-monster-maxhp">0</span>
                            </div>
                            <p>Награда: <strong id="current-monster-reward">0</strong> золота</p>
                        </div>
                        <button class="attack-monster-btn" id="attack-current-monster-btn">
                            Атаковать (<span id="current-monster-damage">0</span> урона)
                        </button>
                    </div>
                </div>

                <div class="monsters-info">
                    <h3><i class="fas fa-info-circle"></i> Виды монстров</h3>
                    <div class="monsters-list">
                        <div class="monster-info-item" data-id="goblin">
                            <i class="fas fa-ghost"></i> Гоблин (HP: 10, Награда: 5)
                        </div>
                        <div class="monster-info-item" data-id="orc">
                            <i class="fas fa-user-injured"></i> Орк (HP: 30, Награда: 15)
                        </div>
                        <div class="monster-info-item" data-id="troll">
                            <i class="fas fa-mountain"></i> Тролль (HP: 100, Награда: 50)
                        </div>
                        <div class="monster-info-item" data-id="dragonling">
                            <i class="fas fa-dragon"></i> Дракончик (HP: 200, Награда: 100)
                        </div>
                        <div class="monster-info-item" data-id="demon">
                            <i class="fas fa-fire"></i> Демон (HP: 500, Награда: 250)
                        </div>
                    </div>
                </div>

                <div class="monster-log" style="display: none;">
                    <h3><i class="fas fa-history"></i> Последние бои</h3>
                    <div id="monster-log-content">
                        <div>Убейте монстра, чтобы получить золото!</div>
                    </div>
                </div>
            </section>

            <!-- Вкладка Статистика -->
            <section id="stats-tab" class="tab-content">
                <h2><i class="fas fa-chart-bar"></i> Ваша статистика</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3><i class="fas fa-trophy"></i> Общий урон</h3>
                        <p id="total-damage">0</p>
                    </div>
                    <div class="stat-card">
                        <h3><i class="fas fa-skull"></i> Убито монстров</h3>
                        <p id="monsters-killed">0</p>
                    </div>
                    <div class="stat-card">
                        <h3><i class="fas fa-money-check-alt"></i> Всего золота</h3>
                        <p id="total-gold-earned">100</p>
                    </div>
                    <div class="stat-card">
                        <h3><i class="fas fa-clock"></i> Время игры</h3>
                        <p id="play-time">0 минут</p>
                    </div>
                </div>
                <div class="save-section">
                    <h3><i class="fas fa-save"></i> Сохранение игры</h3>
                    <p>Прогресс автоматически сохраняется каждую минуту.</p>
                    <button id="save-btn"><i class="fas fa-save"></i> Сохранить сейчас</button>
                    <button id="reset-btn"><i class="fas fa-trash"></i> Сбросить игру</button>
                </div>
            </section>
        </main>

        <!-- Фиксированная панель навигации внизу экрана -->
        <nav class="fixed-tabs">
            <button class="fixed-tab-btn active" data-tab="boss">
                <i class="fas fa-skull-crossbones"></i>
                <span>Главный босс</span>
            </button>
            <button class="fixed-tab-btn" data-tab="shop">
                <i class="fas fa-shopping-cart"></i>
                <span>Магазин</span>
            </button>
            <button class="fixed-tab-btn" data-tab="monsters">
                <i class="fas fa-spider"></i>
                <span>Монстры</span>
            </button>
            <button class="fixed-tab-btn" data-tab="stats">
                <i class="fas fa-chart-line"></i>
                <span>Статистика</span>
            </button>
        </nav>

        <footer>
            <p>MLBB Битва с Боссами &copy; 2025 | Для Telegram Mini Apps</p>
            <p class="hint"><i class="fas fa-lightbulb"></i> Подсказка: Золото нужно для улучшений, улучшения помогут победить босса!</p>
        </footer>

        <!-- Контейнер для попапов урона -->
        <div id="damage-popups-container"></div>
    </div>

    <!-- Уведомления -->
    <div id="notification" class="notification"></div>

    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script src="script.js"></script>
    
    <script>
        // Инициализация Telegram Web App
        if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
            const tg = Telegram.WebApp;
            
            // Инициализация
            tg.expand();
            tg.enableClosingConfirmation();
            tg.setHeaderColor('#0f0c29');
            tg.setBackgroundColor('#0f0c29');
            
            // Скрываем нижнюю кнопку, так как у нас будет кнопка в поле ввода
            tg.MainButton.hide();
            
            // Настраиваем интерфейс для мобильных устройств
            tg.isExpanded = true;
            tg.enableClosingConfirmation();
            
            // Отправляем данные в бота при необходимости
            tg.ready();
            
            console.log('Telegram Web App initialized in mobile mode');
            
            // Добавляем обработчик для кнопки "Назад" в Telegram
            tg.BackButton.onClick(function() {
                tg.close();
            });
        } else {
            console.log('Running in browser mode');
        }
    </script>
</body>
</html>
