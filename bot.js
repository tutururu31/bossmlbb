const TelegramBot = require('node-telegram-bot-api');

// –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π)
const token = '8323888701:AAEOfkfk5Oncd1xSdFeUVKfTe0-655_MArc';

// URL –≤–∞—à–µ–≥–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π)
const webAppUrl = 'https://tutururu31.github.io/bossmlbb/';

// –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
const bot = new TelegramBot(token, { polling: true });

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    const firstName = msg.from.first_name;
    
    const welcomeText = `–ü—Ä–∏–≤–µ—Ç, ${firstName}! üéÆ\n\n` +
        '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ *MLBB –ë–∏—Ç–≤–∞ —Å –ë–æ—Å—Å–∞–º–∏*!\n\n' +
        'üéØ *–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–≥—Ä—ã:*\n' +
        '‚Ä¢ –°—Ä–∞–∂–∞–π—Å—è —Å –±–æ—Å—Å–æ–º –Ω–∞ 100,000 HP\n' +
        '‚Ä¢ –ü–æ–∫—É–ø–∞–π —É–ª—É—á—à–µ–Ω–∏—è –≤ –º–∞–≥–∞–∑–∏–Ω–µ\n' +
        '‚Ä¢ –§–∞—Ä–º–∏ –º–æ–Ω—Å—Ç—Ä–æ–≤ –¥–ª—è –∑–æ–ª–æ—Ç–∞\n' +
        '‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏\n\n' +
        '–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É!';
    
    // –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å Web App –∫–Ω–æ–ø–∫–æ–π (–ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ –≤–≤–æ–¥–∞)
    const options = {
        reply_markup: {
            keyboard: [
                [{
                    text: 'üéÆ –ò–ì–†–ê–¢–¨ –°–ï–ô–ß–ê–°',
                    web_app: { url: webAppUrl }
                }],
                ['üìñ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å?', 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞']
            ],
            resize_keyboard: true,
            one_time_keyboard: false
        },
        parse_mode: 'Markdown'
    };
    
    bot.sendMessage(chatId, welcomeText, options);
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /game
bot.onText(/\/game/, (msg) => {
    const chatId = msg.chat.id;
    
    const options = {
        reply_markup: {
            keyboard: [
                [{
                    text: 'üéÆ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É',
                    web_app: { url: webAppUrl }
                }]
            ],
            resize_keyboard: true,
            one_time_keyboard: false
        }
    };
    
    bot.sendMessage(chatId, '–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É:', options);
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help
bot.onText(/\/help/, (msg) => {
    const chatId = msg.chat.id;
    
    const helpText = 'üéÆ *MLBB –ë–∏—Ç–≤–∞ —Å –ë–æ—Å—Å–∞–º–∏*\n\n' +
        'üìñ *–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*\n' +
        '/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n' +
        '/game - –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É\n' +
        '/help - –ü–æ–º–æ—â—å\n' +
        '/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Å–∫–æ—Ä–æ)\n\n' +
        'üéØ *–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:*\n' +
        '1. –ù–∞–∂–º–∏ "–ò–≥—Ä–∞—Ç—å —Å–µ–π—á–∞—Å"\n' +
        '2. –ë–µ–π –±–æ—Å—Å–∞ –∫–ª–∏–∫–∞–º–∏\n' +
        '3. –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –∑–æ–ª–æ—Ç–æ –Ω–∞ –º–æ–Ω—Å—Ç—Ä–∞—Ö\n' +
        '4. –ü–æ–∫—É–ø–∞–π —É–ª—É—á—à–µ–Ω–∏—è\n' +
        '5. –ü–æ–±–µ–¥–∏ –±–æ—Å—Å–∞!\n\n' +
        'üì¢ *–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞:*\n' +
        '–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º –ø–∏—à–∏—Ç–µ @tutururu31';
    
    bot.sendMessage(chatId, helpText, { parse_mode: 'Markdown' });
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /stats
bot.onText(/\/stats/, (msg) => {
    const chatId = msg.chat.id;
    
    const statsText = 'üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã*\n\n' +
        '–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n\n' +
        '–°–∫–æ—Ä–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ:\n' +
        '‚Ä¢ –í–∏–¥–µ—Ç—å —Å–≤–æ–π –æ–±—â–∏–π —É—Ä–æ–Ω\n' +
        '‚Ä¢ –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏\n' +
        '‚Ä¢ –ü–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è\n' +
        '‚Ä¢ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –Ω–µ–¥–µ–ª—è–º\n\n' +
        '–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏!';
    
    bot.sendMessage(chatId, statsText, { parse_mode: 'Markdown' });
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—ã—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
bot.on('message', (msg) => {
    const chatId = msg.chat.id;
    const text = msg.text;
    
    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
    if (text.startsWith('/')) return;
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫
    if (text === 'üìñ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å?') {
        const howToPlayText = 'üéÆ *–ö–∞–∫ –∏–≥—Ä–∞—Ç—å –≤ MLBB –ë–∏—Ç–≤–∞ —Å –ë–æ—Å—Å–∞–º–∏:*\n\n' +
            '1. *–ì–ª–∞–≤–Ω—ã–π –±–æ—Å—Å* - –∫–ª–∏–∫–∞–π –ø–æ –±–æ—Å—Å—É, —á—Ç–æ–±—ã –Ω–∞–Ω–æ—Å–∏—Ç—å —É—Ä–æ–Ω\n' +
            '2. *–ú–∞–≥–∞–∑–∏–Ω* - –ø–æ–∫—É–ø–∞–π —É–ª—É—á—à–µ–Ω–∏—è –∑–∞ –∑–æ–ª–æ—Ç–æ:\n' +
            '   ‚Ä¢ –£—Å–∏–ª–µ–Ω–Ω—ã–π —É–¥–∞—Ä - –±–æ–ª—å—à–µ —É—Ä–æ–Ω–∞ –∑–∞ –∫–ª–∏–∫\n' +
            '   ‚Ä¢ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—å–µ—Ç –±–æ—Å—Å–∞\n' +
            '   ‚Ä¢ –®–∞–Ω—Å –∫—Ä–∏—Ç–∞ - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞—Ä–∞\n' +
            '   ‚Ä¢ –°–∏–ª–∞ –∫—Ä–∏—Ç–∞ - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª—å –∫—Ä–∏—Ç–∞\n' +
            '   ‚Ä¢ –û–≥–Ω–µ–Ω–Ω–∞—è –∞—É—Ä–∞ - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —É—Ä–æ–Ω\n' +
            '3. *–ú–æ–Ω—Å—Ç—Ä—ã* - —É–±–∏–≤–∞–π –º–æ–Ω—Å—Ç—Ä–æ–≤, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–æ–ª–æ—Ç–æ\n' +
            '4. *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞* - —Å–ª–µ–¥–∏ –∑–∞ —Å–≤–æ–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º\n\n' +
            'üí° *–°–æ–≤–µ—Ç—ã:*\n' +
            '‚Ä¢ –°–Ω–∞—á–∞–ª–∞ —É–±–µ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–Ω—Å—Ç—Ä–æ–≤ –¥–ª—è –∑–æ–ª–æ—Ç–∞\n' +
            '‚Ä¢ –£–ª—É—á—à–∞–π —É—Ä–æ–Ω –∑–∞ –∫–ª–∏–∫\n' +
            '‚Ä¢ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –±–æ—Å—Å–∞\n' +
            '‚Ä¢ –ó–æ–ª–æ—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π\n\n' +
            '–£–¥–∞—á–∏ –≤ –∏–≥—Ä–µ! üèÜ';
        
        bot.sendMessage(chatId, howToPlayText, { parse_mode: 'Markdown' });
    } else if (text === 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞') {
        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        bot.sendMessage(chatId, 'üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞*\n\n–§—É–Ω–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–∫–æ—Ä–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è!', { parse_mode: 'Markdown' });
    } else if (text === 'üéÆ –ò–ì–†–ê–¢–¨ –°–ï–ô–ß–ê–°' || text === 'üéÆ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É') {
        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É "–ò–≥—Ä–∞—Ç—å —Å–µ–π—á–∞—Å", –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
        bot.sendMessage(chatId, '–û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É, –Ω–∞–∂–∞–≤ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ üëá', {
            reply_markup: {
                keyboard: [
                    [{
                        text: 'üéÆ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É',
                        web_app: { url: webAppUrl }
                    }]
                ],
                resize_keyboard: true,
                one_time_keyboard: false
            }
        });
    } else {
        // –û—Ç–≤–µ—Ç –Ω–∞ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        bot.sendMessage(chatId, '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã:\n/start - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã\n/game - –æ—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É\n/help - –ø–æ–º–æ—â—å\n\n–ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫ –≤ –º–µ–Ω—é.');
    }
});

// –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
console.log('ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...');
console.log('üëâ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞');
console.log(`üåê –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: ${webAppUrl}`);
console.log('üìù –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ—Ç–∞ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C');

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
bot.on('polling_error', (error) => {
    console.error('–û—à–∏–±–∫–∞ polling:', error);
});

bot.on('webhook_error', (error) => {
    console.error('–û—à–∏–±–∫–∞ webhook:', error);
});
